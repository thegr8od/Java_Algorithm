-- 코드를 입력하세요
SELECT a.author_id, b.author_name, a.category, sum(a.price * c.sum) as total_sales
from book a
join author b
on a.author_id = b.author_id
join (select book_id, sum(sales) as sum
      from book_sales
      where sales_date like '2022-01%'
      group by book_id
      ) c
on a.book_id = c.book_id
group by  a.author_id, b.author_name, a.category
order by a.author_id, a.category desc


# 9000 * 35
# 12000 * 66

# book_id	sales_date	sales
# 2	2022-01-01 00:00:00	5
# 1	2022-01-02 00:00:00	3
# 7	2022-01-02 00:00:00	4
# 4	2022-01-03 00:00:00	8
# 1	2022-01-04 00:00:00	2
# 2	2022-01-04 00:00:00	9
# 3	2022-01-04 00:00:00	4
# 5	2022-01-04 00:00:00	1
# 6	2022-01-04 00:00:00	2
# 1	2022-01-05 00:00:00	6
# 7	2022-01-05 00:00:00	9
# 1	2022-01-06 00:00:00	6
# 3	2022-01-06 00:00:00	6
# 4	2022-01-06 00:00:00	2
# 5	2022-01-06 00:00:00	9
# 6	2022-01-06 00:00:00	5
# 2	2022-01-07 00:00:00	10
# 5	2022-01-07 00:00:00	8
# 6	2022-01-08 00:00:00	1
# 7	2022-01-08 00:00:00	10
# 3	2022-01-09 00:00:00	7
# 4	2022-01-09 00:00:00	5
# 5	2022-01-09 00:00:00	9
# 6	2022-01-09 00:00:00	4
# 1	2022-01-10 00:00:00	3
# 2	2022-01-11 00:00:00	2
# 3	2022-01-11 00:00:00	5
# 5	2022-01-11 00:00:00	6
# 6	2022-01-11 00:00:00	3
# 5	2022-01-12 00:00:00	9
# 7	2022-01-12 00:00:00	3
# 4	2022-01-13 00:00:00	7
# 1	2022-01-14 00:00:00	1
# 2	2022-01-14 00:00:00	3
# 6	2022-01-14 00:00:00	5
# 7	2022-01-14 00:00:00	1
# 3	2022-01-15 00:00:00	9
# 5	2022-01-15 00:00:00	10
# 2	2022-01-16 00:00:00	8
# 4	2022-01-16 00:00:00	10
# 5	2022-01-16 00:00:00	9
# 3	2022-01-17 00:00:00	5
# 5	2022-01-17 00:00:00	9
# 6	2022-01-17 00:00:00	4
# 1	2022-01-18 00:00:00	3
# 7	2022-01-18 00:00:00	10
# 4	2022-01-19 00:00:00	6
# 5	2022-01-19 00:00:00	9
# 2	2022-01-20 00:00:00	2
# 3	2022-01-20 00:00:00	7
# 6	2022-01-20 00:00:00	10
# 7	2022-01-20 00:00:00	5
# 1	2022-01-21 00:00:00	8
# 4	2022-01-21 00:00:00	8
# 3	2022-01-22 00:00:00	4
# 7	2022-01-22 00:00:00	7
# 5	2022-01-23 00:00:00	2
# 7	2022-01-23 00:00:00	8
# 1	2022-01-24 00:00:00	1
# 2	2022-01-24 00:00:00	3
# 6	2022-01-24 00:00:00	5
# 3	2022-01-25 00:00:00	3
# 4	2022-01-25 00:00:00	8
# 5	2022-01-25 00:00:00	8
# 6	2022-01-25 00:00:00	1
# 7	2022-01-25 00:00:00	9
# 2	2022-01-26 00:00:00	8
# 5	2022-01-26 00:00:00	8
# 1	2022-01-27 00:00:00	1
# 3	2022-01-28 00:00:00	1
# 4	2022-01-28 00:00:00	6
# 6	2022-01-28 00:00:00	2
# 2	2022-01-29 00:00:00	10
# 7	2022-01-29 00:00:00	10
# 5	2022-01-30 00:00:00	8
# 6	2022-01-30 00:00:00	4
# 7	2022-01-30 00:00:00	10
# 1	2022-01-31 00:00:00	1
# 2	2022-01-31 00:00:00	6