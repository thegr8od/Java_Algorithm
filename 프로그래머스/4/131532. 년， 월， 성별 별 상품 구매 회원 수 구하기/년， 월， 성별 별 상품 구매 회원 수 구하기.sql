-- 코드를 입력하세요
# SELECT year(sales_date) as year, month(sales_date) as month, b.gender as gender, count(b.gender) as users
# from online_sale a
# join user_info b
# on a.user_id = b.user_id
# where gender is not null
# group by year(sales_date), month(sales_date), b.gender
# order by year(sales_date), month(sales_date)

select b.year, b.month, a.gender, count(*) as users
from user_info a
join (select year(sales_date) as year, month(sales_date) as month, user_id
      from online_sale
      group by year, month, user_id
      order by year,month) b
on a.user_id = b.user_id
where gender is not null
group by b.year, b.month, a.gender
order by b.year, b.month, a.gender


# 1	2	26	1	2022-01-01 00:00:00
# 2	7	1	1	2022-01-01 00:00:00
# 3	45	15	1	2022-01-01 00:00:00
# 4	154	7	1	2022-01-02 00:00:00
# 5	12	7	1	2022-01-02 00:00:00
# 6	152	7	1	2022-01-02 00:00:00
# 7	109	5	1	2022-01-02 00:00:00
# 8	120	4	1	2022-01-03 00:00:00
# 9	57	25	1	2022-01-03 00:00:00
# 10	109	13	1	2022-01-05 00:00:00
# 11	117	7	1	2022-01-05 00:00:00
# 12	2	30	1	2022-01-05 00:00:00
# 13	131	19	1	2022-01-05 00:00:00
# 14	154	29	1	2022-01-05 00:00:00
# 15	15	12	3	2022-01-05 00:00:00
# 16	90	24	2	2022-01-07 00:00:00
# 17	162	30	2	2022-01-07 00:00:00
# 18	92	26	1	2022-01-08 00:00:00
# 19	123	14	1	2022-01-08 00:00:00
# 20	126	9	1	2022-01-08 00:00:00
# 21	58	11	2	2022-01-08 00:00:00
# 22	149	8	1	2022-01-09 00:00:00
# 23	65	19	2	2022-01-09 00:00:00
# 24	23	7	1	2022-01-09 00:00:00
# 25	81	20	1	2022-01-12 00:00:00
# 26	42	19	1	2022-01-12 00:00:00
# 27	117	12	1	2022-01-12 00:00:00
# 28	108	27	1	2022-01-14 00:00:00
# 29	56	28	1	2022-01-15 00:00:00
# 30	4	27	2	2022-01-15 00:00:00
# 31	143	15	2	2022-01-15 00:00:00
# 32	84	8	1	2022-01-15 00:00:00
# 33	113	15	2	2022-01-17 00:00:00
# 34	120	29	1	2022-01-17 00:00:00
# 35	68	15	1	2022-01-17 00:00:00
# 36	127	29	1	2022-01-17 00:00:00
# 37	57	11	1	2022-01-17 00:00:00
# 38	134	18	1	2022-01-18 00:00:00
# 39	99	27	1	2022-01-18 00:00:00
# 40	101	9	1	2022-01-21 00:00:00
# 41	7	5	2	2022-01-21 00:00:00
# 42	29	15	1	2022-01-22 00:00:00
# 43	73	21	2	2022-01-22 00:00:00
# 44	23	26	2	2022-01-22 00:00:00
# 45	160	23	2	2022-01-22 00:00:00
# 46	134	26	1	2022-01-24 00:00:00
# 47	27	3	1	2022-01-24 00:00:00
# 48	15	12	3	2022-01-24 00:00:00
# 49	34	6	2	2022-01-24 00:00:00
# 50	151	26	2	2022-01-25 00:00:00
# 51	55	30	3	2022-01-25 00:00:00
# 52	78	19	1	2022-01-26 00:00:00
# 53	93	3	2	2022-01-26 00:00:00
# 54	114	1	1	2022-01-27 00:00:00
# 55	58	26	1	2022-01-27 00:00:00
# 56	118	1	2	2022-01-28 00:00:00
# 57	87	24	2	2022-01-29 00:00:00
# 58	22	8	1	2022-01-31 00:00:00
# 59	102	18	1	2022-01-31 00:00:00
# 60	117	22	1	2022-01-31 00:00:00
# 61	35	8	1	2022-01-31 00:00:00